import timeimport osimport argparseimport shleximport subprocessimport schedule# function to create directoriesdef create_dir(target_dir):    if not os.path.exists(target_dir):        try:            os.makedirs(target_dir)        except:            pass# function to execute command in shelldef run_command(command):    process = subprocess.Popen(shlex.split(command), stdout=subprocess.PIPE)    while True:        output = process.stdout.readline()        if process.poll() is not None:            break        if output:            print(output.strip())    rc = process.poll()    return rcdef use_ffmpeg(f_image_resolution,f_recording_duration,f_webcam,f_video_folder,f_camera_id):        # record using ffmpeg    command_line = 'ffmpeg -f video4linux2 -input_format mjpeg -s {}x{} -t {} -timestamps abs -i /dev/video{} \                    -force_key_frames "expr:gte(t,n_forced*60)" \                    -copyts -vcodec libx264 -pix_fmt yuv420p -preset veryfast -r 15 \                    -f ssegment -segment_atclocktime 1 -segment_time 900.000 \                    -strftime 1 {}{}_%Y-%m-%d-%H-%M-%S.mp4'.format(f_image_resolution[0],f_image_resolution[1],f_recording_duration,f_webcam,f_video_folder,f_camera_id)    run_command(command_line)        def start_recording(f_recording_time,f_image_resolution,f_recording_duration,f_webcam,f_video_folder,f_camera_id):        print('\nStarting webcam recording for {} at {}'.format(f_camera_id,f_recording_time))        # schedule jobs    schedule.every().day.at(f_recording_time).do(use_ffmpeg,f_image_resolution=f_image_resolution,f_recording_duration=f_recording_duration,f_webcam=f_webcam,f_video_folder=f_video_folder,f_camera_id=f_camera_id)        # start scheduler    try:        while True:            schedule.run_pending()            time.sleep(1)    except KeyboardInterrupt:        print('\nEnding scheduler...')    """----------------------------- options -----------------------------"""parser = argparse.ArgumentParser(description='Webcam Process')parser.add_argument('--station', type=int,                    help='id for station')parser.add_argument('--webcam', type=int, default=0,                    help='id for webcam')parser.add_argument('--webcam_dir', type=str, default='../outputs/',                    help='location of webcam drive')parser.add_argument('--image_resolution', type=str, default='[1920,1080]',                    help='image resolution of webcam')parser.add_argument('--recording_time', type=str,                    help='recording time of webcams format %H:%M')parser.add_argument('--recording_duration', type=str,                    help='duration of webcam recording')args = parser.parse_args()if __name__ == "__main__":        # create necessary variables    station_id = args.station    webcam = int(args.webcam)    image_resolution = eval(args.image_resolution)    recording_time = args.recording_time    recording_duration =args.recording_duration    camera_id = '{}_{}'.format(args.station,args.webcam)    code_dir = os.getcwd() +'/'        create_dir(args.webcam_dir)    os.chdir(args.webcam_dir)    webcam_dir = os.getcwd() +'/'    os.chdir(code_dir)        # create main folders    video_raw_folder = webcam_dir + 'video_raw/'    create_dir(video_raw_folder)        # raise image resolution of selected cameras    #if camera_id in ['0_2','1_4','2_0']:    #    image_resolution = [3840,2160]    # start recording    start_recording(recording_time,image_resolution,recording_duration,webcam,video_raw_folder,camera_id)        